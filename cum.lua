--[[
update 0.3.1(zapp04)
добавил warn для некоторых команд
добавил звук после активации команды
сделал чтоб код не выглядел как гавно после драгма
звук при запуске скрипта
]]

--[[
update 0.3(DragM_ & zapp04)
добавил __giveammo
добавил __metall
добавил возможность включения/отключения для некоторых комманд
добавил __soundspam
добавил __altsoundspam
добавил __bvzlom
]]

--[[
update 0.2(zapp04)
теперь код выглядит менее как залупа
добавил показ версии
при запуске скрипта clogo больше не принтится в консоль, только при использовании команды
добавил __changelog
вырезал vip_check(бесполезно)
вырезал reputation(не работает)
добавил __rgbline
]] 

--[[
update 0.1(DragM_)
драгм создал хуйню  
]]

-- переменные 
local _cM = _cM
local cum = _cM or {} and _G // говноедство
local cmd = concommand.Add
local tc = timer.Create
local ts = timer.Stop
local nstart = net.Start
local ssound = surface.PlaySound

// переделать эту залупу ебаную
--[[
local trash = trash or {} // пиздец но работает так что похуй
trash["addons/111mod/lua/autorun/client/cl_dises.lua"] = true

local info = debug.getinfo(1)
local function block(...)
    if (info and info.short_src and trash[info.short_src]) then
        error("test", 1)
    end
end

debug.sethook(block, "c")
]]

cum.metal = false
cum.ammo = false
cum.soundspam = false
cum.soundspam2 = false
cum.barieraye = false
 
cum.ver = "0.4 [dev]"
cum.warn = [[!!!!!НЕ ОТКРЫВАЙ ЧАТ ПОКА ЭТА ХУЙНЯ РАБОТАЕТ!!!!!]]
cum.lastupdlog = [[
изменил переменные
начал переработку оформления помощи
трахнул код кароче похуй работает
|%| следующий апдейт должен глобальным(добавление поддержки других серверов)
]]

cum.clogo = [[

 ::::::::  :::    ::: ::::    ::::  
:+:    :+: :+:    :+: +:+:+: :+:+:+ 
+:+        +:+    +:+ +:+ +:+:+ +:+ 
+#+        +#+    +:+ +#+  +:+  +#+ 
+#+        +#+    +#+ +#+       +#+ 
#+#    #+# #+#    #+# #+#       #+# 
 ########   ########  ###       ### 

C.U.M. - Common Utility Mod
version: ]] .. cum.ver .. [[

|1|oldhl2rp|37.230.210.97:27017|:
__cumoldhl2help - команды для данного сервера
__changelog - список последних обновлений скрипта
__rgbline - скит полоска сверху(не детектится скринграбом)

__sadmcheck - проверка суперадминов
__admcheck - проверка админов

__krasnikod - включить/отключить красный код
__zheltikod - включить/отключить желтый код
__rabochayafaza - включить/отключить рабочую фазу

__giveammo - включить/отключить выдачу патрон(работает не на все оружия)
__metall - включить/отключить выдачу предметов для крафта
__soundspam - включить/отключить еблю ушей у всех кто находится рядом
__altsoundspam - включить/отключить альтернативный метод ебли ушей
__bvzlom - включить/отключить спам взломом барьера(минус чат и уши у го)
]]
/* 
|%|servername|ip|:
__cumserverhelp - 
*/



-- функции
local function helpme()
    ssound("buttons/lever7.wav")
    MsgC(Color(255, 255, 255), cum.clogo) 
end

local function changelog()
    ssound("buttons/lever7.wav")
    print(cum.lastupdlog)
end

local function superadmin_check()
    ssound("buttons/lever7.wav")

    for _, p in ipairs(player.GetAll()) do
        if (IsValid(p) and p:IsSuperAdmin()) then
            print(p:GetUserGroup(), '\t', p:Name(), '\t', p)
        end
    end
end

local function admin_check()
    ssound("buttons/lever7.wav")

    for _, p in ipairs(player.GetAll()) do
        if (IsValid(p) and (p:GetUserGroup() ~= "vip") and (p:GetUserGroup() ~= "user") and (p:GetUserGroup() ~= "vip+")) then
            print(p:GetUserGroup(), '\t', p:Name(), '\t', p)
        end
    end
end

local function sec_pidor()
    ssound("buttons/lever7.wav")
    nstart("terminalCP_yellowcode")
    net.SendToServer()
end

local function KaMeHIIIuK()
    ssound("buttons/lever7.wav")
    nstart("terminalCP_workingphase")
    net.SendToServer()
end

local function sec_huesos()
    ssound("buttons/lever7.wav")
    nstart("terminalCP_redcode")
    net.SendToServer()
end

local function ammoyes()
    ssound("buttons/lever7.wav")

    if !cum.ammo then
        cum.ammo = true

        tc("ayeammo", 0.3, 0, function()
            nstart("giveammo")
            net.SendToServer()
        end)
    else
        cum.ammo = false
        ts("ayeammo")
    end
end

local function metallolom()
    ssound("buttons/lever7.wav")

    if !cum.metal then
        cum.metal = true

        tc("ayemetall", 0.3, 0, function()
            nstart("RemoveTrashAndAddItem")
            net.SendToServer()
        end)
    else
        cum.metal = false
        ts("ayemetall")
    end
end

local function chatsoundspam()
    ssound("buttons/lever7.wav")

    if !cum.soundspam then
        cum.soundspam = true
        MsgC(Color(255, 0, 0), warn)

        tc("soundspamt", 0.1, 0, function()
            nstart("snd.starc_tchat")
            net.SendToServer()
        end)
    else
        cum.soundspam = false
        ts("soundspamt")
    end
end

local function chatsoundspam2()
    ssound("buttons/lever7.wav")

    if !cum.soundspam2 then
        MsgC(Color(255, 0, 0), warn)
        cum.soundspam2 = true

        tc("soundspamd", 0.1, 0, function()
            nstart("snd.endchat")
            net.SendToServer()
        end)
    else
        cum.soundspam2 = false
        ts("soundspamd")
    end
end

local function zlombariera()
    ssound("buttons/lever7.wav")

    if !cum.barieraye then
        cum.barieraye = true

        tc("zlom04ka", 0.3, 0, function()
            nstart("vzlomb")
            net.SendToServer()
        end)
    else
        cum.barieraye = false
        ts("zlom04ka")
    end
end

local function rgbline()
    ssound("buttons/lever7.wav")

    meth_lua_api.callbacks.Add("OnHUDPaint", "rgb", function()
        surface.SetDrawColor(HSVToColor(RealTime() * 120 % 360, 1, 1))
        surface.DrawRect(0, 0, 2000, 3)
    end)
end

-- консольные команды
cmd("__cumoldhl2help", helpme)
cmd("__sadmcheck", superadmin_check)
cmd("__admcheck", admin_check)
cmd("__krasnikod", sec_pidor)
cmd("__zheltikod", sec_huesos)
cmd("__rabochayafaza", KaMeHIIIuK)
cmd("__changelog", changelog)
cmd("__giveammo", ammoyes)
cmd("__rgbline", rgbline)
cmd("__metall", metallolom)
cmd("__soundspam", chatsoundspam)
cmd("__altsoundspam", chatsoundspam2)
cmd("__bvzlom", zlombariera)

--звук при запуске
ssound("buttons/button9.wav")    
